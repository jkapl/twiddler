<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="moment.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $tweetList = $('#tweetList');
        // var index = streams.home.length - 1;
        // while(index >= 0){
        //   var tweet = streams.home[index];
        //   var $tweet = $('<div></div>');
        //   $tweet.text('@' + tweet.user + ': ' + tweet.message + tweet.created_at + moment(tweet.created_at).fromNow());
        //   $tweet.appendTo($body);
        //   index -= 1;
        // }
        function getNewTweets() {
          var index = streams.home.length - 1;
          var tweet = streams.home[index];
          //var $tweet = $('<li></li>');
          //$tweet.html('@' + tweet.user + ': ' + tweet.message + ' ' + moment(tweet.created_at).fromNow())
          //$tweet.text('@' + tweet.user + ': ' + tweet.message + ' ' + moment(tweet.created_at).fromNow());
          //$tweet.appendTo($tweetList);
          $('<li><span id=' + tweet.user + '>' + '<strong>' + tweet.user + '</strong>' + '</span>' + ': ' + tweet.message + ' | ' + moment(tweet.created_at).fromNow() + '</li>').appendTo($tweetList);

          if ($('#tweetList li').length > 10) { $('#tweetList li')[0].remove() }
        }

        var tweetInterval = setInterval(getNewTweets, 2000);

        setTimeout(() => {clearInterval(tweetInterval)}, 10000)

        $('#tweetList').on('click', 'li span', function() { 
          clearTimeline();
          var jUser = $(this).text()
          for (var i=0; i<streams.users[jUser].length; i++)
            $('<li>' + streams.users[jUser][i].message + '</li>').appendTo($('#userTimeline'));
        })

        function clearTimeline () {
          var list = $('#userTimeline li');
          for (var i=0; i< list.length; i++) {
            $(list).remove();
          }
        }

      });

    </script>

    <h1>Twiddler</h1>

    <ul id='tweetList'>
    </ul>
    <ul id='userTimeline'>
    </ul>


  </body>
</html>
