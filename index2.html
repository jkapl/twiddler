<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="moment.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $tweetList = $('#tweetList');

        function getNewTweets() {
          var index = streams.home.length - 1;
          var tweet = streams.home[index];

          $('<li><span id=' + tweet.user + '>' + '<strong>' + tweet.user + '</strong>' + '</span>' + ': ' + tweet.message + ' | ' + '<span id=createdDate>' + moment(tweet.created_at).fromNow() + '</span>' + '</li>').appendTo($tweetList);

          if ($('#tweetList li').length > 20) { $('#tweetList li')[0].remove() }
        }

        var tweetInterval = setInterval(getNewTweets, 2000);
        // var timeInterval = setInterval(updateTimes, 30000);

        setTimeout(() => {clearInterval(tweetInterval)}, 30000)
        // setTimeout(() => {clearInterval(timeInterval)}, 30001)
        

        $('#tweetList').on('click', 'li span', function() { 
          clearTimeline();
          var jUser = $(this).text()
          for (var i=0; i<streams.users[jUser].length; i++)
            $('<li>' + streams.users[jUser][i].message + '</li>').appendTo($('#userTimeline'));
        })

        function clearTimeline () {
          var list = $('#userTimeline li');
          for (var i=0; i< list.length; i++) {
            $(list).remove();
          }
        }

        // function updateTimes () {
        //   var times = $('li #createdDate');
        //   for (var i=0; i<times.length; i++) {
            
        //       //.html(moment(tweet.created_at).fromNow())
        //   }
        // }

      });

    </script>

    <h1>Twiddler</h1>

    <ul id='tweetList'>
    </ul>
    <ul id='userTimeline'>
    </ul>


  </body>
</html>
